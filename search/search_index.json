{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Getting started","text":""},{"location":"#getting-started","title":"Getting started","text":""},{"location":"#about","title":"About","text":"<p>Welcome to the Clockor2 documentation! The Clockor2 app can be found at clockor2.github.io. </p> <p>Clockor2 is a client-side web application for conducting root-to-tip (RTT) regression - the fastest and most widely used method to calibrate strict molecular clocks.</p> <p>Clockor2 also uniquely allows users to quickly fit local molecular clocks using RTT regression, thus handling the increasing complexity of phylodynamic datasets that sample beyond the assumption homogeneous host populations. Clockor2 is efficient, handling trees of up to the order of 104 tips, with significant speed increases compared to other RTT regression applications.</p> <p>We hope it is of use if you need to calibrate a molecular clock, or 2!</p> <p>Info</p> <p>Although clockor2 is written as a web application, all data processing happens on the client-side, meaning that data never leaves the user\u2019s computer.</p>"},{"location":"#what-is-root-to-tip-regression","title":"What is root-to-tip regression?","text":"<p>RTT regression is probably the most commonly used way to test for temporal signal (ie. a consistent rate of evolution) and detect the presence of obvious outliers (e.g. samples with incorrect collection dates) among a dataset of serially sampled genomes.</p> <p>Starting with a phylogenetic tree relating the samples, the central idea is that one performs a regression between the evolutionary distance from each sample to the root against the associated sampling times. If there is temporal signal in the dataset, then we expect to see a clear relationsip between more recent sampling and increased evolutionary distance, relative to older samples. We therefore this relationship with a simple linear regression, and the R2 value gives a measure of temporal signal (also referred to as \"clocklike behaviour\").</p>"},{"location":"#citation","title":"Citation","text":"<p>If you use Clockor2 in your work, please consider citing [ADD CITATION SOON].</p>"},{"location":"#useful-references","title":"Useful references","text":"<ul> <li> <p>TempEst, by Rambaut et al. (2016) - the pioneering software for assessing temporal signal.</p> </li> <li> <p>Reviews on calibrating the molecular clock in temporally structured data by Rieux and Balloux. (2016) and Duchene and Duchene (2020).</p> </li> </ul>"},{"location":"install/","title":"Installation","text":""},{"location":"install/#installation","title":"Installation","text":"<p>The Clockor2 app is readily available at clockor2.github.io. However, some users prefer to install Clockor2 as a standalone app. Clockor2 is a progressive web app (PWA) that can be installed as a native feeling application.</p> <p></p> <p>Open https://clockor2.github.io in Chrome and click the install link in the menu bar.</p> <p></p> <p>Note</p> <p>If the install link is not visible your browser may not support installing PWAs (only tested with Chrome Version 114.0.5735.106).</p> <p>This will open Chrome's install app prompt. Click install and Clockor2 will be install as a standalone Chrome app. </p> <p></p> <p>On macOS you can add Clockor2 to the doc by right clicking the Clockor2 icon and selecting Options &gt; Keep in Dock.</p> <p></p>"},{"location":"examples/mers/","title":"Basic Usage","text":""},{"location":"examples/mers/#basic-usage","title":"Basic Usage","text":""},{"location":"examples/mers/#outline","title":"Outline","text":"<p>We begin by analysing a tree of 274 MERS-CoV samples from human and camel hosts, originally published in Dudas et al. 2017. You can load this example tree from the clockor2.github.io landing page. We compare the fit of a global strict clock and  local clock for each host species.</p>"},{"location":"examples/mers/#step-1-parsing-metadata","title":"Step 1 - Parsing Metadata","text":"<p>Tip labels are formatted as as <code>INFO_HOST_DATE</code>. Accordingly, we select <code>_</code> as the label delimeter, <code>-1</code> as the date position, and <code>-2</code> as the group variable position.</p> <p></p>"},{"location":"examples/mers/#step-2-initial-regression","title":"Step 2 - Initial regression","text":"<p>Upon loading, clockor2 performs a root-to-tip (RTT) regressions and presents the data alongside the tree. Regression values can be accessed by toggling the information panel at the bottom. </p> <p></p> <p>The regression data is coloured by group, but you can also view points coloured as a single global clock by clicking in the legend, which is a feature of plotly. </p>"},{"location":"examples/mers/#step-3-best-fitting-root","title":"Step 3 - Best Fitting Root","text":"<p>Upon inspecting the RTT regression data, it is clear that all points conform to a similar evolutionary rate (slope, ~1.1x10-3). The global clock model presents better overall R2  and is supported by the BIC (our recommended information criterion). </p> <p>We can also find the best fitting root of the tree to re-asses the trend. To do this, click on the best fitting root button, and clockor2 will find the best fitting root in the background, while the application remains usable. </p> <p></p> <p>Again, we recover mote support for a single global clock with a similar rate to the original rooting of ~1.1x10-3. Note, using the icon in the top right of the tree panel, you can change the tree layout as we have done here.</p>"},{"location":"examples/mers/#step-4-using-the-clock-search","title":"Step 4 - Using the clock search","text":"<p>Finally, we demonstrate how one might use the clock search algorithm to support a decision about a number of molecular clocks to use. So far, the data definitively suggest a global clock is best.</p> <p>Info</p> <p>If you plan to use the clock search feature for your own research, see the second tutorial that details its limitations. It is only designed for exploration in conjunction with a biological hypothesis. The clock search naively searches for clusters of points (local clocks) that might have a better fit. It is therefore extremely prone to inflating the number of local clocks, and this vulnerability worsens when searching for more clocks of a minimum group size. Simply searching for an arbitrary number of clocks says nothing about the data at hand.</p> <p>We can perform a search for local clocks by clicking the clock search icon in the information panel. In this case, we test for a maximum of 2 clocks, leaving the minimum group size a the default ( = #tips / #clocks). </p> <p>In general, the user must select a maximum number of clocks to search for, a minimum group size (min number of tips per local clock), and an information criterion to base the search on. The maximum number of clocks must be less than or equal to the total number of tips divided by the minimum group size. We strongly suggest using the BIC because this most heavily penalises the addition of new model parameters through additional local clocks.</p> <p>We also emphasise that the clock search is only suitable where there is a biological hypothesis for the maximum number of clocks. In the MERS data at hand, we are testing the biological hypothesis that there is a different substitution rate between camel and human hosts. </p> <p>The search also runs in the background, meaning the user can continue to use the applcation in the meantime. In this case, the clock search favours a global clock.</p> <p></p>"},{"location":"examples/mers/#summary","title":"Summary","text":"<p>This tutorial has demonstrated how to use all of the features of clockor2. We hope you find it useful next time you need to test the fit of a molecular clock, or 2!</p>"},{"location":"examples/sars-cov-2/","title":"Know the limitations","text":""},{"location":"examples/sars-cov-2/#know-the-limitations","title":"Know the limitations","text":""},{"location":"examples/sars-cov-2/#outline","title":"Outline","text":"<p>Here we analyse a SARS-CoV-2 dataset from Porter et al. 2023 consisting of human and mink hosts across Denmark and Norway. We find support for a local clocks corresponding to human and mink samples in agreement with Porter et al. 2023. We also use the dataset to highlight key limitations when selecting the best fitting root using the clock search algorithm.</p>"},{"location":"examples/sars-cov-2/#step-1-parsing-metadata","title":"Step 1 - Parsing Metadata","text":"<p>Tip labels are formatted as <code>HOST|LOCATION|DATE</code>. Accordingly, we select <code>|</code> as the label delimeter, <code>-1</code> as the date position, and <code>0</code> as the group variable position.</p> <p></p>"},{"location":"examples/sars-cov-2/#step-2-initial-regression","title":"Step 2 - Initial Regression","text":"<p>Upon loading, we see that both mink groups have a similar evolutionary rate that is distinct from that of the human samples.</p> <p></p>"},{"location":"examples/sars-cov-2/#step-3-best-fitting-root","title":"Step 3 - Best Fitting Root","text":"<p>We can now see if this trend holds when we select the best fitting root. </p> <p></p> <p>The evolutionary rate for each local clock appears similar under the best fitting root, but <code>mink_Norway</code> clade effectively acting as a outgroup is questionable.</p> <p>This is a great example where optimising in statistical metric departs from biological reality.When finding the best fitting root, the only objective is to maximise $R^2$, so root positions can be proposed that don't make sense biologically. In this case, the best fitting root causes  Norwegian mink samples to fall close to the root, which could be misinterpreted as suggesting that Norwegian mink samples are somehow ancestral to the rest. However, in the original data, the mink clades are nested within human samples, which makes far more biological sense in the context of SARS-CoV-2's spread. </p> <p>The takehome here is not to use the best fitting root if it's inconsistent with the underlying biological hypothesis.</p>"},{"location":"examples/sars-cov-2/#step-4-local-clock-search","title":"Step 4 - Local Clock Search","text":"<p>Returning to the original root, we can perform a clock search for 3 local clocks to see if we recover support for three local clocks across human hosts and mink from Denmark and Norway. We use a minimum group size of 29 (= size of the smallest mink-clade) and the BIC (our suggest information criterion).</p> <p>Quick recap: The clock search looks for all possible combinations of local clocks with greater than or equal to the minimum number of tips and up to and including the maximum number of clocks. At each step, it calculates an information criterion and eventually chooses the configuration with the most favourable Information criterion. In general, we suggest using the BIC as it penalises the number of group most heavily, thus favouring more evolutionarily parsimonious configurations.</p> <p></p> <p>The analysis selects 3 clocks, but only one of these consincides with host type (the upper most group consists of mink_Norway samples). The lower two are a conflation of human and <code>mink_Denmark</code> samples. </p> <p>This usefully demonstrates an important limitation of the clock search feature - it selects groups based on an information criterion without accounting group similarity. In other words, it favours groups of points that form the tightest fit around a regression slope, rather than any biological similarity. Thus, although human and <code>mink_Denmark</code> samples clearly present samples from two transmission chains, both sample types are grouped in a biologically inconsistent way. Conversely, the <code>mink_Norway</code> samples are isolated in the tree by a long branch, which translates into the isolated island of points at the top of the RTT plane, which the clock seatch converges on. </p> <p>In this way, the clock search behaves similarly to the search for the best fitting root by blindly seeking to optimise a statistical metric. In fact, in the Clokcor2 citation we show that the clock search metric is extremely prone to overfitting and will usually select the maximum number of clocks allowable. </p> <p>Thus, we strongly suggest only ever using the clock search where there is a biological hypothesis regarding the number of clocks. It is intended to provide corroborating rather than definitive evidence</p>"},{"location":"examples/sars-cov-2/#step-5-key-working-knowledge","title":"Step 5 - Key Working-Knowledge","text":"<p>The key takehome here is that statistical optimisations in Clockor2 (the best fitting root and local clock search) are unaware to the biological background of a dataset. If you have a biological reason to use a particular root position instead of the best fitting root, stick to that. Never rely on the clock search to tease out underly local clocks without a bioloigcal hypothesis for where local clocks might exist. You will almostly certainly be overfitting otherwise!</p>"},{"location":"features/1_loadTree/","title":"Loading Trees and Data","text":""},{"location":"features/1_loadTree/#loading-trees-and-data","title":"Loading Trees and Data","text":"<p>Trees are loaded from the landing page and must be in newick format.</p> <p>Users then have the option of loadiing dates and other metadata from tip labels or from a .csv. Video demonstrations of both are given below.</p> <p>The layout of the tree can be modified using the button on the top right of the tree panel.</p>"},{"location":"features/1_loadTree/#video-demonstration","title":"Video Demonstration","text":"<p>Video for loading data from a csv coming soon!</p>"},{"location":"features/2_bfr/","title":"Finding the best fitting root","text":""},{"location":"features/2_bfr/#finding-the-best-fitting-root","title":"Finding the best fitting root","text":""},{"location":"features/2_bfr/#video-demonstration","title":"Video Demonstration","text":""},{"location":"features/2_bfr/#what-is-the-best-fitting-root-bfr","title":"What is the best fitting root (BFR)?","text":"<p>The best fitting root refers to the rooting of the input tree that maximises temporal signal. In other words, which rooting of the tree yields a dataset of root-to-tip distances and sampling times that give the best fitting regression?</p> <p>Of course, this question requires us to nominate a way of measuring the best fitting regression. Clockor2 focuses on two intuitive metrics for doing so the - R2 and and the residual mean squared (RMS).</p> <p>Both can be thought of measuring how closely points fit the regression line. R2 values near 0 correspond to worse fit, while values near 1 correspond to better fit. The RMS is proportional to the sum of the vertical distances, squared, from each point to the regression line. Thus lower values correspond to better fit.</p> <p>When finding the BFR, Clockor2 reroots the tree on each branch and optimises the point to place the root. It then performs a root to tip regression and untimately selects the configuration with the highest R2 or RMS.</p> <p>Either metric may yield a more suitable result depending on the dataset, so users are given able to choose between optimising R2 and RMS. In general, using the RMS is slightly faster. Using either metric and for trees up to a 1000 tips in size, finding the BFR takes seconds. Trees on the order of 104 tips require minutes.</p> <p>Finally, Clockor2 only caluclates the BFR once for either metric, and this remains available for faster access later on.</p>"},{"location":"features/3_userClock/","title":"User Selected Clock","text":""},{"location":"features/3_userClock/#user-selected-clock","title":"User Selected Clock","text":""},{"location":"features/3_userClock/#video-demonstration","title":"Video Demonstration","text":""},{"location":"features/3_userClock/#about","title":"About","text":"<p>Users can interactively select clades or groups of points to create a local clock. </p>"},{"location":"features/3_userClock/#notes","title":"Notes","text":"<p>The clock configuration is currently automatically reset once the tree changes, such as by moving to the best fitting root.</p> <p>Load the tree without the group variable and select points to remove outliers. </p> <p>Non-monopyletic tips can be selected on the tree using crtl+click.</p>"},{"location":"features/4_clockSearch/","title":"Performing a clock Search","text":""},{"location":"features/4_clockSearch/#performing-a-clock-search","title":"Performing a clock Search","text":""},{"location":"features/4_clockSearch/#video-demonstration","title":"Video Demonstration","text":""},{"location":"features/4_clockSearch/#about-the-clock-search-feature","title":"About the clock search feature","text":"<p>Caution</p> <p>The clock search feature is only intended as an exploratory function for local clocks. It is not a formal test for the fit of local clocks. </p> <p>The clock search feature takes a maximum number of loal clocks to search for alongside a minimum number of tips for each local clock. The clock search is slower for larger values of the maximum number of clocks and smaller values of the minimum number of tips.</p> <p>In brief, the clock search starts with one global clock and iteratively adds clocks for every combination of clades that satisfy the minimum number of tips. It chooses the best configuration based on the selected information criterion. We suggest using the BIC as it penalises the addiditon of local clocks most heavily, and is hence more evolutionarily parsimonious.</p> <p>See the the Examples for more detail on interpreting clock search output, especially the tutorial titled Know the limidations.</p>"}]}